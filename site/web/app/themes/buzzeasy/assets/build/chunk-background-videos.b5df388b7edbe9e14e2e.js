webpackJsonp([0],{30:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(34),s=Array.from(document.querySelectorAll(".js-background-video"));s.length&&s.forEach(function(e){new n.a(e)})},32:function(e,t,i){"use strict";function n(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return i.reduce(function(e,t){return s(e,t)},e.prototype),e}t.a=n;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}},34:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(35),o=i(32),a=i(38),r=i(39),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=function(){function e(t,i){n(this,e),this.el=t&&t.nodeType?t:document.querySelector(t),this.videoIsDirty=!1,this.settings=l({videoLoadTimeout:3e3,requiredBuffer:3e3,sources:["mp4","webm"]},i),this.el&&this.init()}return u(e,[{key:"init",value:function(){this.addSources(),this.initPlayer(),this.load()}},{key:"addSources",value:function(){var e=this,t=document.createDocumentFragment();this.settings.sources.forEach(function(i){var n=e.el.getAttribute("data-bgvideo-source-"+i),s=document.createElement("source");s.setAttribute("type","video/"+i),s.setAttribute("src",n),t.appendChild(s)});this.el.querySelector("video").appendChild(t)}},{key:"load",value:function(){var e=this;this.player.startBuffering(),Object(r.a)(this.settings.videoLoadTimeout).then(function(){e.videoIsDirty||e.player.isPlaying||(e.videoIsDirty=!0,e.player.destroyVideo(),e.player.destroyControls())})}},{key:"initPlayer",value:function(){var e=this;this.player=new s.a(this.el,{onResize:function(t){e.objectFitVideo()},onProgress:function(t){e.videoReady(t)},onLoadedMetaData:function(t){e.videoReady(t)}})}},{key:"videoReady",value:function(e){var t=this;!t.videoIsDirty&&e.bufferPos()>t.settings.requiredBuffer/1e3&&(e.start(),t.videoIsDirty=!0)}}]),e}();Object(o.a)(d,a.a),t.a=d},35:function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=i(32),o=i(36),a=i(5),r=i(37),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},u=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),d=function(){function e(t,i){n(this,e),this.el=t,this.isPlaying=!1,this.onCanPlayThroughCalled=!1,i=i||{},this.settings=l({videoEl:"video",playEl:".js-video-player-play",pauseEl:".js-video-player-pause",toggleEl:".js-video-player-toggle",fireCurrentTime:!1,pauseOnPlayerClick:!0,pauseOnResize:!1},i),this.videoEl=this.el.querySelector(this.settings.videoEl),this.playEl=this.el.querySelector(this.settings.playEl),this.pauseEl=this.el.querySelector(this.settings.pauseEl),this.toggleEl=this.el.querySelector(this.settings.toggleEl),this.controls=[this.pauseEl,this.playEl,this.toggleEl],this.videoEl?this.init():Object(r.a)("Video Module: no videoEl detected")}return u(e,[{key:"init",value:function(){this.addListeners()}},{key:"setNewVideo",value:function(e){this.videoEl.setAttribute("src",e),this.videoEl.load()}},{key:"startBuffering",value:function(){this.videoEl.preload="auto",this.videoEl.load()}},{key:"addListeners",value:function(){var e=this,t=this;window.addEventListener("resize",function(t){e.settings.pauseOnResize&&e.stop(),e.triggerCallback("onResize")}),a.a.subscribe("video-player.playing",function(t,i){i.module.el!==e.el&&e.stop()}),this.playEl&&this.playEl.addEventListener("click",function(t){t.preventDefault(),e.start()}),this.pauseEl&&this.pauseEl.addEventListener("click",function(t){t.preventDefault(),e.stop()}),this.toggleEl&&this.toggleEl.addEventListener("click",function(t){t.preventDefault(),e.toggleVideoPlayState()}),this.videoEl.addEventListener("loadedmetadata",function(t){e.triggerCallback("onProgress")}),this.videoEl.addEventListener("ended",function(t){e.stop(),e.triggerCallback("onEnd")}),this.videoEl.addEventListener("pause",function(t){e.stop({preventRepeatEvent:!0})}),this.videoEl.addEventListener("play",function(t){e.start({preventRepeatEvent:!0})}),this.videoEl.addEventListener("canplaythrough",function(t){e.onCanPlayThroughCalled||e.triggerCallback("onCanPlayThrough"),e.onCanPlayThroughCalled=!0}),this.settings.fireCurrentTime&&this.videoEl.addEventListener("timeupdate",function(i){var n=e.currentTime,s=e.duration;e.triggerCallback("onVideoCurrentTimeUpdate",{module:t,currentTime:n,duration:s})})}},{key:"start",value:function(e){var t=this;e=e||{},this.isPlaying=!0,this.el.classList.add("playing"),this.el.classList.add("is-playing"),this.el.classList.remove("is-paused"),this.toggleEl&&(this.toggleEl.textContent="Pause",this.toggleEl.classList.add("is-playing"),this.toggleEl.classList.remove("is-paused")),this.addVideoEvents(),void 0!==e.preventRepeatEvent&&e.preventRepeatEvent||this._play(),a.a.publish("video-player.playing",{module:t}),t.triggerCallback("onStart")}},{key:"bufferPercentage",value:function(){var e=this.videoEl;return e.duration>0&&e.buffered.length>0?e.buffered.end(0)/e.duration*100:0}},{key:"bufferPos",value:function(){var e=this.videoEl;return e.duration>0&&e.buffered.length>0?e.buffered.end(0):0}},{key:"stop",value:function(e){e=e||{},this.isPlaying=!1,this.el.classList.remove("playing"),this.el.classList.remove("is-playing"),this.el.classList.add("is-paused"),this.toggleEl&&(this.toggleEl.textContent="Play",this.toggleEl.classList.remove("is-playing"),this.toggleEl.classList.add("is-paused")),this.removeVideoEvents(),void 0!==e.preventRepeatEvent&&e.preventRepeatEvent||this._pause(),this.triggerCallback("onStop")}},{key:"addVideoEvents",value:function(){var e=this.toggleVideoPlayState.bind(this);this.settings.pauseOnPlayerClick&&this.videoEl.addEventListener("click",e)}},{key:"toggleVideoPlayState",value:function(){this.isPlaying?this.stop():this.start()}},{key:"removeVideoEvents",value:function(){var e=this.toggleVideoPlayState.bind(this);this.videoEl.removeEventListener("click",e)}},{key:"_play",value:function(){this.videoEl.play()}},{key:"_pause",value:function(){this.videoEl.pause()}},{key:"destroyVideo",value:function(){var e=this.videoEl;e.src;this._pause(),e.src="",e.load(),this.videoEl.remove()}},{key:"destroyControls",value:function(){this.controls.forEach(function(e){return e&&e.remove()})}}]),e}();Object(s.a)(d,o.a),t.a=d},36:function(e,t,i){"use strict";t.a={triggerCallback:function(e){void 0!==this.settings&&void 0!==this.settings[e]&&"function"==typeof this.settings[e]&&this.settings[e](this)}}},37:function(e,t,i){"use strict";var n=function(e){LOCALISED_VARS&&"production"!==LOCALISED_VARS.env&&console.log(e)};t.a=n},38:function(e,t,i){"use strict";t.a={objectFitVideo:function(){if(!("object-fit"in document.body.style)){var e=this.videoEl.videoWidth,t=this.videoEl.videoHeight,i=this.el,n=(e/t).toFixed(2),s=window.getComputedStyle(i),o=parseInt(s.getPropertyValue("width")),a=parseInt(s.getPropertyValue("height"));if("border-box"!==s.getPropertyValue("box-sizing")){var r=s.getPropertyValue("padding-top"),l=s.getPropertyValue("padding-bottom"),u=s.getPropertyValue("padding-left"),d=s.getPropertyValue("padding-right");r=parseInt(r),l=parseInt(l),u=parseInt(u),d=parseInt(d),o+=u+d,a+=r+l}var c,h,v=o/e,g=a/t;v>g?(c=o,h=Math.ceil(c/n)):(h=a,c=Math.ceil(h*n)),this.videoEl.style.width=c+"px",this.videoEl.style.height=h+"px"}}}},39:function(e,t,i){"use strict";function n(e){return new Promise(function(t){setTimeout(t,e)})}t.a=n}});